{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSendGrid initialized successfully\u001b[39m","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTwilio initialized successfully\u001b[39m","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:15:04:154"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":[null,"email"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-22 23:15:04:154"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":[null,"email"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-22 23:15:04:154"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":[null],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:66:55)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:66:55)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:66:55)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-22 23:15:04:154"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSendGrid initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:03:163"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTwilio initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:03:163"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:03:163"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:16:03:163"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mLoaded 7 email templates and 7 SMS templates\u001b[39m","timestamp":"2025-08-22 23:16:03:163"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTemplateService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:03:163"}
{"code":403,"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to send email: Forbidden\u001b[39m","response":{"body":{"errors":[{"field":"from","help":null,"message":"The from address does not match a verified Sender Identity. Mail cannot be sent until this error is resolved. Visit https://sendgrid.com/docs/for-developers/sending-email/sender-identity/ to see the Sender Identity requirements"}]},"headers":{"access-control-allow-headers":"Authorization, Content-Type, On-behalf-of, x-sg-elas-acl","access-control-allow-methods":"POST","access-control-allow-origin":"https://sendgrid.api-docs.io","access-control-max-age":"600","cache-control":"no-cache","connection":"keep-alive","content-length":"281","content-security-policy":"frame-ancestors 'none'","content-type":"application/json","date":"Sat, 23 Aug 2025 06:16:04 GMT","referrer-policy":"strict-origin-when-cross-origin","server":"nginx","strict-transport-security":"max-age=31536000; includeSubDomains","x-content-type-options":"no-sniff","x-no-cors-reason":"https://sendgrid.com/docs/Classroom/Basics/API/cors.html"}},"stack":"Error: Forbidden\n    at node_modules/@sendgrid/client/src/classes/client.js:146:29\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-22 23:16:04:164"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":[null,null,"email","hello@pinpointdigital.us","failed",null,null,"Forbidden","{}"],"query":"\n        INSERT INTO notification_deliveries (\n          id, notification_id, user_id, type, recipient, status, \n          provider_id, provider, sent_at, error_message, metadata\n        ) VALUES (\n  ","timestamp":"2025-08-22 23:16:04:164"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to track delivery: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at DeliveryTracker.trackDelivery (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/DeliveryTracker.js:32:31)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:87:29)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:20","timestamp":"2025-08-22 23:16:04:164"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to send notification: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at DeliveryTracker.trackDelivery (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/DeliveryTracker.js:32:31)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:87:29)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:20","timestamp":"2025-08-22 23:16:04:164"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":[null,null,"email","hello@pinpointdigital.us","failed",null,null,"Database not connected","{}"],"query":"\n        INSERT INTO notification_deliveries (\n          id, notification_id, user_id, type, recipient, status, \n          provider_id, provider, sent_at, error_message, metadata\n        ) VALUES (\n  ","timestamp":"2025-08-22 23:16:04:164"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to track delivery: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at DeliveryTracker.trackDelivery (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/DeliveryTracker.js:32:31)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:104:29)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:20","timestamp":"2025-08-22 23:16:04:164"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSendGrid initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:48:1648"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTwilio initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:48:1648"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:48:1648"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:16:48:1648"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mLoaded 7 email templates and 7 SMS templates\u001b[39m","timestamp":"2025-08-22 23:16:48:1648"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTemplateService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:16:48:1648"}
{"code":403,"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to send email: Forbidden\u001b[39m","response":{"body":{"errors":[{"field":"from","help":null,"message":"The from address does not match a verified Sender Identity. Mail cannot be sent until this error is resolved. Visit https://sendgrid.com/docs/for-developers/sending-email/sender-identity/ to see the Sender Identity requirements"}]},"headers":{"access-control-allow-headers":"Authorization, Content-Type, On-behalf-of, x-sg-elas-acl","access-control-allow-methods":"POST","access-control-allow-origin":"https://sendgrid.api-docs.io","access-control-max-age":"600","cache-control":"no-cache","connection":"keep-alive","content-length":"281","content-security-policy":"frame-ancestors 'none'","content-type":"application/json","date":"Sat, 23 Aug 2025 06:16:49 GMT","referrer-policy":"strict-origin-when-cross-origin","server":"nginx","strict-transport-security":"max-age=31536000; includeSubDomains","x-content-type-options":"no-sniff","x-no-cors-reason":"https://sendgrid.com/docs/Classroom/Basics/API/cors.html"}},"stack":"Error: Forbidden\n    at node_modules/@sendgrid/client/src/classes/client.js:146:29\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-22 23:16:49:1649"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSendGrid initialized successfully\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTwilio initialized successfully\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mLoaded 7 email templates and 7 SMS templates\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTemplateService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-22 23:17:20:1720"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:25:52:2552"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-22 23:25:53:2553"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:27:13:2713"}
{"code":21609,"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to send SMS: The 'StatusCallback' URL undefined/api/notifications/sms-webhook is not a valid URL\u001b[39m","moreInfo":"https://www.twilio.com/docs/errors/21609","stack":"Error: The 'StatusCallback' URL undefined/api/notifications/sms-webhook is not a valid URL\n    at success (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/twilio/lib/base/Version.js:79:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async NotificationService.sendSMS (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:239:23)\n    at async NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:81:18)\n    at async /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:162:20","status":400,"timestamp":"2025-08-22 23:27:13:2713"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSendGrid initialized successfully\u001b[39m","timestamp":"2025-08-22 23:28:32:2832"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTwilio initialized successfully\u001b[39m","timestamp":"2025-08-22 23:28:32:2832"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:28:32:2832"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:28:32:2832"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mLoaded 7 email templates and 7 SMS templates\u001b[39m","timestamp":"2025-08-22 23:28:32:2832"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mTemplateService initialized successfully\u001b[39m","timestamp":"2025-08-22 23:28:32:2832"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to +16199274774\u001b[39m","timestamp":"2025-08-22 23:28:33:2833"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:32:12:3212"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-22 23:32:12:3212"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:35:57:3557"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-22 23:35:58:3558"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:38:12:3812"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-22 23:38:13:3813"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:55:15:5515"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-22 23:55:15:5515"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-22 23:55:21:5521"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to +16199274774\u001b[39m","timestamp":"2025-08-22 23:55:21:5521"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:00:45:045"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-23 00:00:46:046"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:00:49:049"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to +16199274774\u001b[39m","timestamp":"2025-08-23 00:00:50:050"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:01:10:110"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to +16199274774\u001b[39m","timestamp":"2025-08-23 00:01:11:111"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:05:22:522"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-23 00:05:24:524"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:05:26:526"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to 16198817203\u001b[39m","timestamp":"2025-08-23 00:05:26:526"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:06:48:648"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-23 00:06:50:650"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:06:58:658"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to +16199274774\u001b[39m","timestamp":"2025-08-23 00:06:59:659"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:38:34:3834"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mEmail sent successfully to hello@pinpointdigital.us\u001b[39m","timestamp":"2025-08-23 00:38:34:3834"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSkipping compliance checks for demo mode\u001b[39m","timestamp":"2025-08-23 00:38:38:3838"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mSMS sent successfully to 16198817203\u001b[39m","timestamp":"2025-08-23 00:38:38:3838"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mSendGrid API key not found - email notifications disabled\u001b[39m","timestamp":"2025-08-24 10:48:34:4834"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mTwilio credentials not found - SMS notifications disabled\u001b[39m","timestamp":"2025-08-24 10:48:34:4834"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-24 10:48:34:4834"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","sms"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-24 10:48:34:4834"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","sms"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-24 10:48:34:4834"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua"],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-24 10:48:34:4834"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-24 10:48:34:4834"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-24 10:48:34:4834"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-24 10:48:34:4834"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-24 10:48:34:4834"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","email"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-24 10:48:42:4842"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","email"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-24 10:48:42:4842"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua"],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-24 10:48:42:4842"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 10:48:42:4842"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 10:48:42:4842"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 10:48:42:4842"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-24 10:48:42:4842"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mSendGrid API key not found - email notifications disabled\u001b[39m","timestamp":"2025-08-24 11:31:25:3125"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mTwilio credentials not found - SMS notifications disabled\u001b[39m","timestamp":"2025-08-24 11:31:25:3125"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32mNotificationService initialized successfully\u001b[39m","timestamp":"2025-08-24 11:31:25:3125"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","email"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-24 11:31:25:3125"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","email"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-24 11:31:25:3125"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua"],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-24 11:31:25:3125"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-24 11:31:25:3125"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-24 11:31:25:3125"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-24 11:31:25:3125"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-24 11:31:25:3125"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","sms"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-24 11:31:54:3154"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","sms"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-24 11:31:54:3154"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua"],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-24 11:31:54:3154"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:31:54:3154"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:31:54:3154"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:31:54:3154"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-24 11:31:54:3154"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","sms"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-24 11:33:22:3322"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","sms"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-24 11:33:22:3322"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua"],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-24 11:33:22:3322"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:33:22:3322"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:33:22:3322"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:360:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:33:22:3322"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-24 11:33:22:3322"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","email"],"query":"\n        SELECT id, type, opted_out_at, reason \n        FROM communication_opt_outs \n        WHERE user_id = $1 \n        AND (type = $2 OR type = 'all')\n        AND opted_out_at IS NOT NULL\n        OR","timestamp":"2025-08-24 11:33:48:3348"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua","email"],"query":"\n        SELECT COUNT(*) as count\n        FROM notification_deliveries \n        WHERE user_id = $1 \n        AND type = $2 \n        AND sent_at >= NOW() - INTERVAL '1 hour'\n      ","timestamp":"2025-08-24 11:33:48:3348"}
{"error":"Database not connected","level":"\u001b[31merror\u001b[39m","message":"\u001b[31mDatabase query error:\u001b[39m","params":["allan-chua"],"query":"\n        SELECT \n          email_enabled, \n          sms_enabled, \n          notification_types,\n          quiet_hours_start,\n          quiet_hours_end,\n          timezone\n        FROM notification_pr","timestamp":"2025-08-24 11:33:48:3348"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check opt-out status: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkOptOutStatus (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:62:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:13:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:33:48:3348"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check rate limits: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkRateLimits (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:106:37)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:14:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:33:48:3348"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31mFailed to check user preferences: Database not connected\u001b[39m","stack":"Error: Database not connected\n    at Database.query (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/utils/database.js:57:15)\n    at ComplianceService.checkUserPreferences (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:174:31)\n    at ComplianceService.checkCompliance (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/ComplianceService.js:15:14)\n    at NotificationService.sendNotification (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/services/NotificationService.js:69:57)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/src/server-demo.js:291:46\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/pinpoint/Downloads/Cursor/HOA Connect/hoa-connect-demo/hoa-connect-backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2025-08-24 11:33:48:3348"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33mNotification blocked by compliance:\u001b[39m","timestamp":"2025-08-24 11:33:48:3348"}
